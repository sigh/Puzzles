<nav>
  <li><a href="{{ site.baseurl }}/all">All puzzles</a></li>
  <ul>
    {% for puzzle in site.puzzles %}
    {% assign category = puzzle | puzzle_category %}
    {% assign url = puzzle.url %}
    {% if category != current_category %}
    {% if current_category != '' %}
  </ul>
  {% endif %}
  <li>{{ category | snake_to_words }}</li>
  {% assign current_category = category %}
  <ul>
    {% endif %}
    {% if page.inpage_nav %}
    {% assign href = puzzle | puzzle_id | prepend: '#' %}
    {% else %}
    {% assign href = puzzle.url %}
    {% endif %}
    <li><a href="{{ href }}">{{ puzzle.title }}</a></li>
    {% endfor %}
  </ul>
</nav>